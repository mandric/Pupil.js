/*! pupil 1.0.2 2013-08-28 */
!function(){var a={},b=function(b){a[b]={name:b,toString:function(){return b}}};b("Block"),b("Func"),b("LogicalAnd"),b("LogicalOr"),b("LogicalNot"),"undefined"!=typeof module?module.exports=a:(window.pupil=window.pupil||{},window.pupil.entities=a)}(),function(){var a=function(a){this.tokens=a};a.prototype.tokenize=function(a){a=a.replace(/([^\\])\s+/g,"$1");var b,c=a.split(""),d=[],e=this.tokens,f=function(a,b){d.push({name:a,data:b||null})},g="",h=!1,i=!0,j=[],k=!1;for(b=0;b<c.length;b++){var l=c[b],m=c[b+1];if(i=!0,j=[],k=!1,h?h=!1:"\\"==l?(h=!0,k=!0,i=!1):","==l?j.push([e.Comma]):":"==l?j.push([e.Colon]):"&"==l&&"&"==m?(j.push([e.LogicalAnd]),b++):"|"==l&&"|"==m?(j.push([e.LogicalOr]),b++):"!"==l?j.push([e.LogicalNot]):"("==l?j.push([e.BracketOpen]):")"==l&&j.push([e.BracketClose]),0!==j.length||k||(g+=l,i=!1),b==c.length-1&&(i=!0),i&&""!==g&&(j.unshift([e.Identifier,g]),g=""),j.length>0)for(var n=0;n<j.length;n++)f(j[n][0],j[n][1])}return d},"undefined"!=typeof module?module.exports={create:function(b){return new a(b)}}:(window.pupil=window.pupil||{},window.pupil.lexer=a)}(),function(){var a=function(a){return{type:a,sub:[],funcName:"",funcArgs:[]}},b=function(a,b){this.message=a,this.pos=b},c=function(a,b){this.tokens=a,this.entities=b};c.prototype.parse=function(c){for(var d=this.tokens,e=this.entities,f=a(e.Block),g=[f],h=g[g.length-1],i=null,j=!0,k=1,l=0,m=1,n=0,o=0,p=1,q=0;q<c.length;q++){var r=c[q],s=[],t=!1,u=!1;if(r.name==d.Identifier){if(!k)throw new b("Unexpected identifier",q);j=!1,i?(i.funcArgs.push(r.data),k=0,l=1,n=0,o=1,p=1,m=0):(i=a(e.Func),i.funcName=r.data,k=0,l=1,n=1,o=0,p=0,m=0)}else if(r.name==d.Colon){if(!n)throw new b("Unexpected function arguments",q);j=!1,k=1,l=0,n=0,o=0,p=0,m=0}else if(r.name==d.Comma){if(!o)throw new b("Unexpected function argument separator",q);j=!1,k=1,l=0,n=0,o=0,p=0,m=0}else if(r.name==d.LogicalAnd){if(!l)throw new b("Unexpected logical AND",q);s.push(a(e.LogicalAnd)),j=!0,k=1,l=0,n=0,o=0,p=1,m=1}else if(r.name==d.LogicalOr){if(!l)throw new b("Unexpected logical OR",q);s.push(a(e.LogicalOr)),j=!0,k=1,l=0,n=0,o=0,p=1,m=1}else if(r.name==d.LogicalNot){if(!m)throw new b("Unexpected logical NOT",q);s.push(a(e.LogicalNot)),j=!0,k=1,l=0,n=0,o=0,p=1,m=0}else if(r.name==d.BracketOpen){if(!p)throw new b("Unexpected opening bracket",q);t=!0,j=!0,k=1,l=0,n=0,o=0,p=1,m=1}else r.name==d.BracketClose&&(u=!0,j=!0,k=0,l=1,n=0,o=0,p=0,m=0);if(q==c.length-1&&(j=!0),j&&i&&(s.unshift(i),i=null),s.length>0)for(var v=0;v<s.length;v++)h.sub.push(s[v]);if(t){var w=a(e.Block);g.push(w),h.sub.push(w),h=g[g.length-1]}if(u){if(1===g.length)throw new b("Can't close the root block.",q);g.pop(),h=g[g.length-1]}}if(g.length>1)throw new b("All blocks weren't closed.");return f},"undefined"!=typeof module?module.exports={create:function(a,b){return new c(a,b)}}:(window.pupil=window.pupil||{},window.pupil.parser=c)}(),function(){var a=null,b=null,c=null,d=null,e=null,f=null,g=!1,h={},i=function(){"undefined"!=typeof module?(a=require("./tokens.js"),b=require("./entities.js"),c=require("./validator_functions.js"),d=require("./lexer.js").create(a),e=require("./parser.js").create(a,b),f=require("./validator.js").create(c,b)):(a=window.pupil.tokens,b=window.pupil.entities,c=window.pupil.validator_functions,d=new window.pupil.lexer(a),e=new window.pupil.parser(a,b),f=new window.pupil.validator(c,b)),g=!0},j=function(a,b){g||i(),c[a.toLowerCase()]=b},k=function(a,b){g||i();var c={};for(var j in b){var k,l,m=a[j];m?(h[m]?l=h[m]:(k=d.tokenize(m),l=e.parse(k),h[m]=l),c[j]=f.validate(l.sub,b,j)):c[j]=!0}return c};"undefined"!=typeof module?module.exports={addFunction:j,validate:k}:(window.pupil=window.pupil||{},window.pupil.addFunction=j,window.pupil.validate=k)}(),function(){var a={},b=function(b){a[b]={name:b,toString:function(){return b}}};b("Identifier"),b("Colon"),b("Comma"),b("LogicalAnd"),b("LogicalOr"),b("LogicalNot"),b("BracketOpen"),b("BracketClose"),"undefined"!=typeof module?module.exports=a:(window.pupil=window.pupil||{},window.pupil.tokens=a)}(),function(){var a=function(a,b){this.validatorFunctions=a,this.entities=b};a.prototype.validate=function(a,b,c){for(var d=this.validatorFunctions,e=this.entities,f=!0,g=1,h=!1,i=0;i<a.length;i++){var j=a[i],k=!0,l=!1;if(j.type==e.LogicalAnd)g=1;else if(j.type==e.LogicalOr)g=2;else if(j.type==e.LogicalNot)h=!0;else if(j.type==e.Func){for(var m=j.funcName.toLowerCase(),n=[],o=0;o<j.funcArgs.length;o++)n.push(j.funcArgs[o]);if("other"==m.substr(0,5)){m=m.substr(5);var p=n.shift();n.unshift(b[p])}else n.unshift(b[c]);n.unshift(b),k=d[m].apply(this,n),l=!0}else j.type==e.Block&&(k=this.validate(j.sub,b,c),l=!0);l&&(h&&(k=!k,h=!1),f=1==g?f&&k:f||k,l=!1)}return f},"undefined"!=typeof module?module.exports={create:function(b,c){return new a(b,c)}}:(window.pupil=window.pupil||{},window.pupil.validator=a)}(),function(){var a={},b={alpha:new RegExp("^[a-zA-Z]+$"),alphanumeric:new RegExp("^[a-zA-Z0-9]+$"),email:new RegExp(/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?/i)};a={equals:function(a,b,c){return b==c},iequals:function(a,b,c){return b.toLowerCase()==c.toLowerCase()},sequals:function(a,b,c){return b===c},siequals:function(a,b,c){return b.toLowerCase()===c.toLowerCase()},lenmin:function(a,b,c){return b.length>=c},lenmax:function(a,b,c){return b.length<=c},min:function(a,b,c){return parseFloat(b,10)>=c},max:function(a,b,c){return parseFloat(b,10)<=c},between:function(a,b,c,d){var e=parseFloat(b,10);return e>=c&&d>=e},"in":function(a,b){var c=Array.prototype.slice.call(arguments);c.shift(),c.shift();for(var d=c,e=0;e<d.length;e++)if(d[e]==b)return!0;return!1},required:function(a,b){return!!b},optional:function(){return!0},numeric:function(a,b){return!isNaN(parseFloat(b))&&isFinite(b)},alpha:function(a,c){return b.alpha.test(c)},alphanumeric:function(a,c){return b.alphanumeric.test(c)},email:function(a,c){return b.email.test(c)},regex:function(a,b,c,d){return d=d||"",new RegExp(c,d).test(b)},integer:function(a,b){return parseInt(b,10)==b},equalsto:function(a,b,c){return b==a[c]}},"undefined"!=typeof module?module.exports=a:(window.pupil=window.pupil||{},window.pupil.validator_functions=a)}();